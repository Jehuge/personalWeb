# 从零构建个人综合展示平台：FastAPI + React 全栈实践

> 本文记录了一个集博客、摄影作品、AI实验展示于一体的个人综合展示平台的完整开发过程，涵盖技术选型、架构设计、核心功能实现与开发心得。

## 项目背景

作为一个独立开发者，我一直在寻找一个既能展示技术实力，又能呈现创作内容的平台。市面上的通用博客系统要么功能过于单一，要么定制化程度不够。于是，我决定从零开始构建一个属于自己的综合展示平台。

这个平台需要满足以下需求：
- **多内容类型**：支持博客文章、摄影作品、AI项目展示
- **前后端分离**：管理后台与展示前端独立部署
- **现代化技术栈**：使用当前主流且高效的技术
- **可扩展性**：便于后续功能扩展和维护

## 技术栈选型

### 后端：FastAPI + SQLAlchemy + MySQL

选择 **FastAPI** 作为后端框架，主要基于以下考虑：

1. **性能优异**：基于 Starlette 和 Pydantic，性能接近 Node.js 和 Go
2. **类型安全**：原生支持 Python 类型提示，配合 Pydantic 实现数据验证
3. **自动文档**：自动生成 OpenAPI/Swagger 文档，开发体验极佳
4. **异步支持**：原生支持 async/await，适合 I/O 密集型应用

```python
# app/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI(
    title=settings.APP_NAME,
    version=settings.APP_VERSION,
    description="个人综合展示网站API"
)

# CORS 配置
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.CORS_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

数据库选择 **MySQL** 配合 **SQLAlchemy 2.0** 的异步引擎，既保证了数据可靠性，又充分利用了异步性能优势。

### 前端管理后台：React + TypeScript + Vite + Ant Design

管理后台采用 **React 18** + **TypeScript**，构建工具选择 **Vite**（相比 Webpack 启动速度提升 10 倍以上）。

UI 框架选择 **Ant Design 5**，原因：
- 组件丰富，开箱即用
- 设计规范统一，减少 UI 设计时间
- TypeScript 支持完善

状态管理使用 **Zustand**，相比 Redux 更轻量，API 更简洁：

```typescript
// admin/src/store/authStore.ts
export const useAuthStore = create<AuthState>()(
  persist(
    (set, get) => ({
      token: null,
      user: null,
      isAuthenticated: false,
      
      login: async (username: string, password: string) => {
        const response = await api.post('/auth/login', formData)
        const { access_token } = response.data
        set({ token: access_token, isAuthenticated: true })
        api.defaults.headers.common['Authorization'] = `Bearer ${access_token}`
      },
    }),
    { name: 'auth-storage', storage: createJSONStorage(() => localStorage) }
  )
)
```

### 前端展示站：React + TypeScript + Vite

展示站同样使用 React + TypeScript，但 UI 完全自定义，实现：
- 深色/浅色主题切换
- Hero 区域动画效果
- 图片懒加载与响应式布局
- 时间线展示

### 云存储：阿里云 OSS

选择阿里云 OSS 存储图片和媒体文件，主要优势：
- CDN 加速，全球访问速度快
- 成本可控，按量付费
- API 简单易用

## 系统架构设计

### 三层架构

```
┌─────────────┐   REST API   ┌──────────────┐
│ Web 前台    │ <──────────> │ FastAPI 核心 │
│ (React)     │              │ app/main.py  │
└─────────────┘              └──────────────┘
         ↑                           ↑
         │                           │
┌─────────────┐   私有 API   ┌──────────────┐
│ Admin 管理端│ <──────────> │ DB/OSS 层     │
│ (React)     │              │ MySQL + OSS   │
└─────────────┘              └──────────────┘
```

### 模块化设计

后端采用模块化路由设计，每个功能模块独立：

```
app/
  core/         # 核心配置（数据库、安全、初始化）
  api/          # API 路由（auth/blog/photo/ai/media/upload/user）
  models/       # SQLAlchemy 数据模型
  schemas/      # Pydantic 数据验证模型
  utils/        # 工具函数（OSS 服务等）
```

这种设计的优势：
- **职责清晰**：每个模块只负责特定功能
- **易于测试**：模块间耦合度低
- **便于扩展**：新增功能只需添加新模块

## 核心功能实现

### 1. JWT 认证系统

实现基于 JWT 的无状态认证，包含登录、令牌刷新、权限验证：

```python
# app/core/security.py
def create_access_token(data: dict, expires_delta: Optional[timedelta] = None) -> str:
    """创建JWT访问令牌"""
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, settings.SECRET_KEY, algorithm=settings.ALGORITHM)
    return encoded_jwt
```

前端通过 Axios 拦截器自动添加 Token：

```typescript
// admin/src/utils/api.ts
api.interceptors.request.use((config) => {
  const token = useAuthStore.getState().token
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})
```

### 2. 图片上传与处理

实现了完整的图片上传流程，包括：
- **自动压缩**：根据配置压缩图片大小
- **EXIF 提取**：自动提取相机参数（焦距、光圈、快门、ISO）
- **缩略图生成**：自动生成 WebP 格式缩略图
- **多级目录**：按年月自动组织文件结构

```python
# app/utils/oss.py
def upload_image(
    self,
    image_content: bytes,
    file_path: str,
    max_size: Optional[tuple] = None,
    quality: int = 85
) -> Optional[dict]:
    """上传图片到OSS，支持压缩和缩略图生成"""
    # 提取 EXIF 信息
    raw_exif, exif_summary = _extract_exif_metadata(image_content)
    
    # 打开并压缩图片
    image = Image.open(io.BytesIO(image_content))
    if max_size:
        image.thumbnail(max_size, Image.Resampling.LANCZOS)
    
    # 上传原图
    image_url = self.upload_file(compressed_content, file_path, content_type)
    
    # 生成 WebP 缩略图
    thumbnail.thumbnail((400, 400), Image.Resampling.LANCZOS)
    thumbnail.save(thumbnail_output, format='WEBP', quality=95)
    
    return {
        "url": image_url,
        "thumbnail_url": thumbnail_url,
        "width": image.size[0],
        "height": image.size[1],
        "focal_length": exif_summary.get("focal_length"),
        "aperture": exif_summary.get("aperture"),
        "shutter_speed": exif_summary.get("shutter_speed"),
        "iso": exif_summary.get("iso"),
    }
```

### 3. 异步数据库操作

使用 SQLAlchemy 2.0 的异步 API，充分利用 Python 的异步特性：

```python
# app/core/database.py
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession, async_sessionmaker

engine = create_async_engine(
    settings.DATABASE_URL,
    echo=settings.DEBUG,
    future=True
)

AsyncSessionLocal = async_sessionmaker(
    engine, class_=AsyncSession, expire_on_commit=False
)

async def get_db():
    async with AsyncSessionLocal() as session:
        yield session
```

所有数据库操作都使用 `async/await`：

```python
@router.get("/blogs", response_model=List[BlogSchema])
async def get_blogs(
    skip: int = 0,
    limit: int = 10,
    db: AsyncSession = Depends(get_db)
):
    result = await db.execute(
        select(Blog)
        .where(Blog.is_published == True)
        .order_by(Blog.published_at.desc())
        .offset(skip)
        .limit(limit)
    )
    return result.scalars().all()
```

### 4. 环境配置管理

使用 `pydantic-settings` 管理环境变量，支持类型验证和默认值：

```python
# app/core/config.py
from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    APP_NAME: str = "个人网站"
    DATABASE_URL: str = "mysql+asyncmy://..."
    SECRET_KEY: str = "your-secret-key"
    OSS_ACCESS_KEY_ID: str = ""
    OSS_BUCKET_NAME: str = ""
    CORS_ORIGINS: Union[str, List[str]] = ["http://localhost:3000"]
    
    class Config:
        env_file = ".env"
        case_sensitive = True

settings = Settings()
```

### 5. 前端状态持久化

使用 Zustand 的 `persist` 中间件，实现登录状态的持久化：

```typescript
export const useAuthStore = create<AuthState>()(
  persist(
    (set, get) => ({
      // ... state and actions
    }),
    {
      name: 'auth-storage',
      storage: createJSONStorage(() => localStorage),
      partialize: (state) => ({ token: state.token }),
      onRehydrateStorage: () => (state) => {
        if (state?.token) {
          api.defaults.headers.common['Authorization'] = `Bearer ${state.token}`
          state.fetchUserInfo()
        }
      },
    }
  )
)
```

## 技术亮点

### 1. 类型安全

从后端到前端，全程使用类型系统：
- **后端**：Pydantic 模型 + Python 类型提示
- **前端**：TypeScript 严格模式

这大大减少了运行时错误，提升了开发效率。

### 2. 自动 API 文档

FastAPI 自动生成交互式 API 文档，访问 `/docs` 即可查看和测试所有接口：

```python
app = FastAPI(
    title=settings.APP_NAME,
    version=settings.APP_VERSION,
    docs_url="/docs",
    redoc_url="/redoc"
)
```

### 3. 图片处理优化

- **智能压缩**：根据原图大小自动选择压缩策略
- **格式转换**：自动转换为 WebP 格式，减少带宽消耗
- **EXIF 保留**：保留相机参数，便于摄影作品展示

### 4. 响应式设计

前端展示站采用响应式设计，适配各种设备：
- 移动端：单列布局，优化触摸交互
- 平板：两列布局
- 桌面：多列网格布局

## 开发心得

### 1. 技术选型要务实

选择技术时，不要盲目追求最新，要考虑：
- **团队熟悉度**：选择团队熟悉的技术，降低学习成本
- **生态成熟度**：选择生态完善的技术，遇到问题容易解决
- **性能需求**：根据实际需求选择，不要过度优化

### 2. 模块化设计很重要

从一开始就做好模块化设计，后续扩展会轻松很多。每个模块职责单一，接口清晰，便于测试和维护。

### 3. 类型系统是朋友

虽然 TypeScript 和 Pydantic 增加了开发时的代码量，但它们能在编译时发现大量错误，大大减少了调试时间。

### 4. 自动化工具提升效率

- **Vite**：极速的开发服务器
- **FastAPI 自动文档**：无需手写 API 文档
- **类型提示**：IDE 自动补全和错误检查

### 5. 渐进式开发

不要一开始就追求完美，先实现核心功能，再逐步完善。这个项目就是先实现了基础的 CRUD，再逐步添加图片处理、EXIF 提取等高级功能。

## 后续规划

1. **性能优化**：实现 Redis 缓存，减少数据库查询
2. **SEO 优化**：为展示站添加 SSR 支持
3. **内容搜索**：集成全文搜索引擎
4. **数据分析**：添加访问统计和分析功能
5. **自动化部署**：配置 CI/CD 流程

## 总结

这个项目从零开始，历时数周，最终实现了一个功能完整、技术栈现代化的个人综合展示平台。通过这个项目，我深入实践了：

- FastAPI 异步 Web 开发
- React + TypeScript 前端开发
- 云存储服务集成
- 图片处理与优化
- 前后端分离架构设计

项目代码已开源，欢迎 Star 和 Fork。如果你也在构建类似的项目，希望这篇文章能给你一些启发。

---

**技术栈总结**：
- 后端：FastAPI + SQLAlchemy + MySQL + 阿里云 OSS
- 管理后台：React + TypeScript + Vite + Ant Design + Zustand
- 展示前端：React + TypeScript + Vite
- 开发工具：Git + VS Code + Postman

**项目地址**：[GitHub Repository]

**在线演示**：[Demo URL]

---

*本文是个人综合展示平台的第一篇技术博客，后续会继续分享更多技术细节和开发经验。*

